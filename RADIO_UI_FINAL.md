# Radio UI Final Design - Implementation

## Изменения

### 1. Левая панель (Player) - компактная по высоте, нормальная ширина

**Размеры**:
- Ширина: **400px** (как было изначально)
- Отступы: **20px horizontal, 10px vertical** (меньше по высоте)
- Spacing: **8px**

**Album Art**:
- Размер: **200x200px** (квадрат)

**Текст**:
- Artist: **12px**
- Song Title: **16px**
- Time labels: **11px**

**Прогресс-бар**:
- Высота groove: **4px**
- Handle: **12x12px**
- Border radius: **6px**

**Кнопки управления**:
- Play/Pause: **40x40px**
- Border radius: **20px**
- Volume button: **28x28px**
- Volume button font: **14px**
- Volume slider width: **100px**
- Control spacing: **10px**
- Between spacing: **15px**

**Кнопка REQUEST SONG**:
- Border radius: **8px**
- Padding: **10px 20px**
- Font size: **12px**

### 2. Плейлист - новый дизайн с полной информацией

**Структура элемента** (горизонтальная):
```
┌────┬──────────┬─────────────────────────────────┬────────┐
│ #  │ [Обложка]│ LABEL (PREVIOUS/NOW/NEXT)       │ 3:45  │
│    │  50x50   │ Song Title                      │        │
│    │          │ Artist Name                     │        │
└────┴──────────┴─────────────────────────────────┴────────┘
```

**Элементы**:
1. **Порядковый номер** (#):
   - Ширина: 30px
   - Цвет: #888
   - Шрифт: 14px, bold
   - По центру

2. **Обложка альбома**:
   - Размер: 50x50px
   - Border-radius: 4px
   - Загружается асинхронно из song.artUrl

3. **Информация о песне**:
   - **Label** (PREVIOUS/NOW PLAYING/NEXT/UPCOMING):
     - Цвет: #4a9eff (текущая) / #aaa (остальные)
     - Размер: 10px, bold
   - **Title**: 14px, bold, white
   - **Artist**: 12px, #888
   - Max width: 400px, no wrap

4. **Длительность**:
   - Ширина: 50px
   - Формат: "M:SS"
   - Цвет: #888
   - Размер: 12px
   - Выравнивание: справа

**Размеры**:
- Высота элемента: **74px** (фиксированная)
- Отступы: **10px 12px** (horizontal/vertical)
- Spacing: **12px**

**Текущая песня**:
- Фон: `rgba(74, 158, 255, 0.2)`
- Border-radius: 4px

### 3. Отладка плейлиста

Добавлена детальная отладка в консоль:
- Размер истории и очереди
- Текущая песня
- Каждая добавленная песня
- Финальное количество элементов

## Файлы изменены

### baseradiopage.h
```cpp
// Добавлено:
int m_songOrderCounter;  // Счетчик порядка песен
```

### baseradiopage.cpp

**setupLeftPanel()** - компактная высота, нормальная ширина:
- Ширина: 400px
- Отступы: 20px, 10px (меньше по вертикали)
- Album art: 200x200px
- Все элементы нормальных размеров

**updateSongList()** - добавлена отладка:
- Выводит размер истории и очереди
- Показывает каждую добавленную песню
- Сбрасывает m_songOrderCounter = 1

**addSongToList()** - полностью переработан:
- Горизонтальная структура (QHBoxLayout)
- Порядковый номер (#)
- Обложка 50x50px с асинхронной загрузкой
- Информация о песне (3 строки)
- Длительность справа
- Фиксированная высота 74px

**updateBackgroundImage()** - обновлен размер:
- scaled(200, 200)

**Инициализация**:
- m_songOrderCounter(1) в конструкторе

## Визуальный результат

### Левая панель (Player)
```
┌──────────────────────┐
│   [200x200]          │  ← Обложка
│    Album Art         │
│                      │
│  Artist (12)         │  ← Текст нормального размера
│ Song Title (16)      │
│ 00:00 ────── 05:15   │  ← Прогресс
│                      │
│    [▶] 🔊 ────────   │  ← Кнопки
│                      │
│   [REQUEST SONG]     │  ← Одна кнопка
└──────────────────────┘
      400px wide
   Компактная высота!
```

### Плейлист (новый дизайн)
```
┌────────────────────────────────────────────────┐
│              PLAYLIST                          │
├───┬────────┬─────────────────────────┬────────┤
│ 1 │ [img]  │ PREVIOUS                │  3:21  │
│   │ 50x50  │ Song Title              │        │
│   │        │ Artist Name             │        │
├───┼────────┼─────────────────────────┼────────┤
│ 2 │ [img]  │ PREVIOUS                │  4:15  │
│   │ 50x50  │ Another Song            │        │
│   │        │ Another Artist          │        │
├───┼────────┼─────────────────────────┼────────┤
│ 3 │ [img]  │ NOW PLAYING (синий фон) │  5:07  │
│   │ 50x50  │ Current Song            │        │
│   │        │ Current Artist          │        │
├───┼────────┼─────────────────────────┼────────┤
│ 4 │ [img]  │ NEXT                    │  2:54  │
│   │ 50x50  │ Next Song               │        │
│   │        │ Next Artist             │        │
├───┼────────┼─────────────────────────┼────────┤
│ 5 │ [img]  │ UPCOMING                │  3:30  │
│   │ 50x50  │ Future Song             │        │
│   │        │ Future Artist           │        │
└───┴────────┴─────────────────────────┴────────┘
```

## Диагностика плейлиста

При обновлении плейлиста в консоль выводится:
```
=== UPDATING SONG LIST ===
History size: 5
Queue size: 3
Current song: Artist - Title
Adding history from index 2 to 5
  Adding PREVIOUS: Artist1 - Song1
  Adding PREVIOUS: Artist2 - Song2
Adding NOW PLAYING: Current Artist - Current Song
Adding 3 songs from queue
  Adding NEXT: Next Artist - Next Song
  Adding UPCOMING: Artist3 - Song3
  Adding UPCOMING: Artist4 - Song4
=== SONG LIST UPDATE COMPLETE - Total items: 6 ===
```

## Проверка

Если плейлист показывает только 1 трек:
1. Проверьте консоль - какие размеры History и Queue?
2. Убедитесь что API возвращает данные
3. Проверьте что `fetchSongHistory(5)` и `fetchQueue()` вызываются

## Тестирование

1. Откройте радио-страницу
2. Проверьте консоль на наличие отладочных сообщений
3. Убедитесь что:
   - ✅ Левая панель 400px широкая, но компактная по высоте
   - ✅ Обложка 200x200px
   - ✅ Плейлист показывает несколько песен
   - ✅ Каждая песня имеет: #, обложку, название, артиста, время
   - ✅ Текущая песня выделена синим фоном
   - ✅ Порядковые номера идут последовательно
